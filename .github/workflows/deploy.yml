name: Deploy to Dagster+ Hybrid

on:
  push:
    branches:
      - main

env:
  DAGSTER_CLOUD_URL: "https://sosuvconsulting.dagster.cloud"
  DAGSTER_CLOUD_ORGANIZATION: "sosuvconsulting"  # Add your organization name

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
      
      - name: Install dagster-cloud CLI
        run: pip install dagster-cloud
      
      - name: Update code location
        env:
          DAGSTER_CLOUD_API_TOKEN: ${{ secrets.DAGSTER_CLOUD_API_TOKEN }}
        run: |
          dagster-cloud workspace add-location \
            --location-name "risk-pipeline" \
            --location-file "." \
            --python-file "definitions.py"
